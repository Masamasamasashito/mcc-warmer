# ==============================================================================
# üöÄ GET READY: First Trial Setup (Quick Start)
# ==============================================================================
# HOW TO START:
# 1. Copy this file to a new file named ".env"
#    Command: cp env.example .env
#
# 2. Generate security keys (Crucial step!)
#    Run the command below for your OS in your terminal to append secrets to .env.
#    (You only need to do this once.)
# ==============================================================================

# ==============================================================================
# üì¶ ADVANCED: Running Multiple Local Environments
# ==============================================================================
# If you want to run a second n8n instance alongside an existing one:
# 1. Create a separate directory for the new environment.
# 2. Change the HOST PORTS in .env to avoid conflicts (e.g., add 10000).
#    - DOCKER_HOST_PORT_N8N_CONTAINER      (e.g., 5678 -> 15678)
#    - DOCKER_HOST_PORT_POSTGRES_CONTAINER (e.g., 5432 -> 15432)
#    - DOCKER_HOST_PORT_REDIS              (e.g., 6379 -> 16379)
#    - DOCKER_HOST_PORT_PLAYWRIGHT         (e.g., 3000 -> 13000) *If enabled
#
# 3. Change ALL VOLUME NAMES in .env to prevent data collision (e.g., add _v2).
#    - N8N_VOLUME_NAME                     (e.g., mccwN8nDataVolume_v2)
#    - PLAYWRIGHT_VOLUME_NAME              (e.g., mccwPlaywrightDataVolume_v2) *If enabled
#    - POSTGRES_VOLUME_NAME                (e.g., mccwPostgresDataVolume_v2)
#    - POSTGRES_USERHOME_VOLUME_NAME       (e.g., mccwPostgresUserHomeVolume_v2)
#    - REDIS_VOLUME_NAME                   (e.g., mccwRedisDataVolume_v2)
#    - CADDY_VOLUME_NAME                   (e.g., mccwCaddyDataVolume_v2)
#    - CADDY_CONFIG_VOLUME_NAME            (e.g., mccwCaddyConfigVolume_v2)
# 4. Access the new instance via the NEW PORT.
#    - URL: [http://localhost:15678/](http://localhost:15678/) (instead of the default [http://localhost:5678/](http://localhost:5678/))
# ==============================================================================

# --- üçé macOS / üêß Linux (Copy & Paste into Terminal) ---
# echo "" >> .env
# echo "N8N_ENCRYPTION_KEY=$(openssl rand -hex 32)" >> .env
# echo "REQ_SECRET=$(openssl rand -hex 32)" >> .env
# echo "POSTGRES_PASSWORD=$(openssl rand -base64 32 | tr -d '/+=')" >> .env
# echo "REDIS_PASSWORD=$(openssl rand -base64 32 | tr -d '/+=')" >> .env

# --- ü™ü Windows PowerShell (Copy & Paste into PowerShell) ---
# "" | Add-Content .env
# $bytes = New-Object byte[] 32; (New-Object System.Security.Cryptography.RNGCryptoServiceProvider).GetBytes($bytes); $hex = -join ($bytes | ForEach-Object { $_.ToString("x2") }); "N8N_ENCRYPTION_KEY=$hex" | Add-Content .env
# $bytes = New-Object byte[] 32; (New-Object System.Security.Cryptography.RNGCryptoServiceProvider).GetBytes($bytes); $hex = -join ($bytes | ForEach-Object { $_.ToString("x2") }); "REQ_SECRET=$hex" | Add-Content .env
# $bytes = New-Object byte[] 32; (New-Object System.Security.Cryptography.RNGCryptoServiceProvider).GetBytes($bytes); $base64 = [Convert]::ToBase64String($bytes) -replace '[\/+=]', ''; "POSTGRES_PASSWORD=$base64" | Add-Content .env
# $bytes = New-Object byte[] 32; (New-Object System.Security.Cryptography.RNGCryptoServiceProvider).GetBytes($bytes); $base64 = [Convert]::ToBase64String($bytes) -replace '[\/+=]', ''; "REDIS_PASSWORD=$base64" | Add-Content .env


# ==============================================================================
# ‚öôÔ∏è Configuration
# ==============================================================================

# ------------------------------------------------------------------------------
# Global Settings
# ------------------------------------------------------------------------------
# Define the timezone once for all services
COMMON_TIMEZONE=Asia/Tokyo

# ------------------------------------------------------------------------------
# Docker Image Versions
# ------------------------------------------------------------------------------
# Pin versions for stability in production (e.g., 1.77.2)
N8N_IMAGE_TAG=latest
# Playwright Version (e.g., 1.49.0)
PLAYWRIGHT_TARGET_VERSION=latest
# Postgres version (e.g., 16-alpine)
POSTGRES_IMAGE_TAG=alpine
# Redis version
REDIS_IMAGE_TAG=alpine


# Caddy version
CADDY_IMAGE_TAG=alpine

# ------------------------------------------------------------------------------
# 1. n8n Core Settings
# ------------------------------------------------------------------------------
# [NOTE] If you ran the commands above, N8N_ENCRYPTION_KEY is already at the bottom of this file.
# Uncomment below ONLY if you want to set a fixed manual key.
# N8N_ENCRYPTION_KEY=your_manual_key_here

DOCKER_HOST_PORT_N8N_CONTAINER=5678
N8N_CONTAINER_LISTEN_PORT=5678 # It is not recommended to change this port ( Defined by container image )
HOSTNAME_N8N_CONTAINER=localhost
N8N_VOLUME_NAME=mccwN8nDataVolume

# Network Binding
# Default to 127.0.0.1 to avoid exposing ports publicly and to prevent conflicts
DOCKER_HOST_BIND_ADDR=127.0.0.1

# Webhook Base URL
# Local default:
N8N_WEBHOOK_URL=http://localhost:5678/
# Production / Caddy (Must use https):
# N8N_WEBHOOK_URL=https://automation.example.com/

N8N_PROTOCOL=http

# ------------------------------------------------------------------------------
# 2. n8n Multi Cloud Cache Warmer (Security)
# ------------------------------------------------------------------------------
# [NOTE] If you ran the commands above, REQ_SECRET is already set.
# Uncomment below ONLY for manual setup.
# REQ_SECRET=your_manual_secret_here

# ------------------------------------------------------------------------------
# 3. n8n Execution Data Pruning (Maintenance)
# ------------------------------------------------------------------------------
N8N_EXECUTIONS_DATA_PRUNE=true
N8N_EXECUTIONS_DATA_MAX_AGE=168       # 168 hours = 7 days
N8N_EXECUTIONS_DATA_PRUNE_MAX_COUNT=5000

# ------------------------------------------------------------------------------
# 4. Playwright (Browser Automation)
# Multi Cloud Cache Warmer accuracy improves, but `docker compose up -d` takes longer, increasing the startup time from 15 to 25 minutes.
# ------------------------------------------------------------------------------
# DOCKER_HOST_PORT_PLAYWRIGHT=3000
# PLAYWRIGHT_CONTAINER_LISTEN_PORT=3000 # It is not recommended to change this port ( Defined by container image )
# PLAYWRIGHT_VOLUME_NAME=mccwPlaywrightDataVolume

# ------------------------------------------------------------------------------
# 5. Postgres Database
# ------------------------------------------------------------------------------
# [NOTE] If you ran the commands above, POSTGRES_PASSWORD is already set.
# Uncomment below ONLY for manual setup.
# POSTGRES_PASSWORD=your_manual_password_here

POSTGRES_USER=n8n
POSTGRES_DB=n8n
DOCKER_HOST_PORT_POSTGRES_CONTAINER=5432
POSTGRES_CONTAINER_LISTEN_PORT=5432 # It is not recommended to change this port ( Defined by container image )
POSTGRES_VOLUME_NAME=mccwPostgresDataVolume
POSTGRES_USERHOME_VOLUME_NAME=mccwPostgresUserHomeVolume

# ------------------------------------------------------------------------------
# 6. Redis ( Queue / Cache )
# ------------------------------------------------------------------------------
# [NOTE] If you ran the commands above, REDIS_PASSWORD is already set.
# Uncomment below ONLY for manual setup.
# REDIS_PASSWORD=your_manual_password_here
DOCKER_HOST_PORT_REDIS=6379
REDIS_CONTAINER_LISTEN_PORT=6379 # It is not recommended to change this port ( Defined by container image )
REDIS_DB=0
REDIS_VOLUME_NAME=mccwRedisDataVolume

# ------------------------------------------------------------------------------
# 7. Caddy (Web Server / Reverse Proxy)
# ------------------------------------------------------------------------------
CADDY_VOLUME_NAME=mccwCaddyDataVolume
CADDY_CONFIG_VOLUME_NAME=mccwCaddyConfigVolume

# ------------------------------------------------------------------------------
# 8. Deployment Profiles
# ------------------------------------------------------------------------------
# Set to 'true' for Production (Enables Secure Cookies, requires HTTPS)
PRODUCTION=false
# N8N_PUBLIC_HOSTNAME=automation.example.com
# ACME_EMAIL=you@example.com

# ------------------------------------------------------------------------------
# Generate Secrets Command Results
# ------------------------------------------------------------------------------


